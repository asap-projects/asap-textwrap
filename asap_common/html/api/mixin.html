
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Mixin support library &#8212; Module: common</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-book-theme.css?digest=84ace793992934648b4de8eed757e5a2" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/sphinx-book-theme.9d8b4a8b9bb19db25eeaddc40d639ba2.js"></script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Masks/Flags manipulation helpers" href="flags.html" />
    <link rel="prev" title="The overload pattern" href="overload.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<div class="col-12 col-md-3 bd-sidebar site-navigation " id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Module: common</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="../api.html">
   API
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="platform.html">
     Platform detection
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="compilers.html">
     Compiler detection
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="overload.html">
     Overload pattern
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Mixin library
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="flags.html">
     Mask/Flags manipulation
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../license.html">
   License
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../version.html">
   Version
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

</div>


          


          
<!-- This is an invisible pixel that we watch to see if we've scrolled. -->
<div class="sbt-scroll-pixel-helper"></div>
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            <div class="topbar-left">
                
                <label class="nav-toggle-button" for="__navigation">
                    <div class="visually-hidden">Toggle navigation</div>
                    <i class="fas fa-bars"></i>
                </label>
                
            </div>
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/api/mixin.rst.txt"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.rst</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/abdes/asap"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/abdes/asap/issues/new?title=Issue%20on%20page%20%2Fapi/mixin.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-mixin-class">
   The mixin class
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#interfaces-and-mixins">
   Interfaces and mixins
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#mixin-implements-interface">
     Mixin implements interface
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#mixin-provides-interface">
     Mixin provides interface
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Mixin support library</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-mixin-class">
   The mixin class
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#interfaces-and-mixins">
   Interfaces and mixins
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#mixin-implements-interface">
     Mixin implements interface
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#mixin-provides-interface">
     Mixin provides interface
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="section" id="mixin-support-library">
<h1>Mixin support library<a class="headerlink" href="#mixin-support-library" title="Permalink to this headline">¶</a></h1>
<p>The idea with mix-ins is to provide a bunch of primitive classes, where each of them models a basic orthogonal concept, and be able to stick them together to compose more complex classes with just the functionality you want. The primitive classes themselves are meant to be used as building blocks. This is extensible since later on you can add other primitive classes to the collection without affecting the existing ones.</p>
<p>A technique for doing this in C++ is using templates and inheritance. The basic idea here is you connect these building blocks together by providing them via the template parameter. You then chain them together, eg. via typedef, to form a new type containing the functionality you want.</p>
<p><strong>What’s a mixin</strong></p>
<p>A mixin is a template struct/class that:<ul class="simple">
<li><p>inherits publicly from its only template parameter (the CRTP pattern). It is allowed to also inherit from other things,</p></li>
<li><p>has a constructor that forwards arguments its does not consume to its base.</p></li>
</ul>
</p>
<p><div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">template</span><span class="o">&lt;</span><span class="n">Base</span><span class="o">&gt;</span><span class="w"></span>
<span class="k">struct</span><span class="w"> </span><span class="nc">my_mixin</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">Base</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="c1">// and any other additional bases</span>

<span class="w">  </span><span class="c1">// A mixin must forward the constructor parameters it does not consume</span>
<span class="w">  </span><span class="c1">// add the parameters to your mixin at the front, before `rest`</span>
<span class="w">  </span><span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span><span class="p">...</span><span class="n">Args</span><span class="o">&gt;</span><span class="w"></span>
<span class="w">  </span><span class="n">my_mixin</span><span class="p">(</span><span class="n">Args</span><span class="o">&amp;&amp;</span><span class="p">...</span><span class="w"> </span><span class="n">rest</span><span class="p">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">Base</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">forward</span><span class="o">&lt;</span><span class="n">Args</span><span class="o">&gt;</span><span class="p">(</span><span class="n">rest</span><span class="p">)...)</span><span class="w"> </span><span class="p">{}</span><span class="w"></span>

<span class="w">  </span><span class="c1">// public interface methods</span>

<span class="w">  </span><span class="c1">// private state</span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</p>
<p>Mixins can have state, which should be implemented with private data members. Access to the state information should be provided via the public interface. That way, mixins are self-contained, their interface is clear and conflicts with other mixins are minimized.</p>
<p><em>Composing mixins</em> Mixins are added to a class using chain inheritance, where each layer inherits from the layer before it. At the end, the resulting class (which is the one we’ll be using) is the most derived class and provides the interfaces of all mixins used to build it.</p>
<p>One problem remains though: just like that, mixins are restricted on which functionality they can use from other mixins. Interoperability between mixins works only in the direction of the inheritance chain. For example, if we are using a logging mixin with a persistence mixin, then the persistence mixin can use the logging interface as long as it is mixed-in after the logging mixin. But this is not really what we want as conceptually, mixins are a set and we want to be able to compose them in any order we want.</p>
<p>In order to deal with this elegantly, we automatically add a top layer in the chain (not a mixin), that will track the ‘most derived class’ (the one with all the mixins interfaces) and offer access to a <code class="docutils literal notranslate"><span class="pre">self</span></code> that is the result of casting <code class="docutils literal notranslate"><span class="pre">this</span></code> to that <strong>most derived class</strong>. This layer is the initial base in the inheritance chain and is therefore visible from any other mixin.</p>
<p>When defining a concrete class using mixins, you don’t need to do anything to benefit from the above quality of life improvement. Simply declare mixins as usual and access their interfaces via <code class="docutils literal notranslate"><span class="pre">this-&gt;self()</span></code>. We need to have <code class="docutils literal notranslate"><span class="pre">this-&gt;</span></code> because <code class="docutils literal notranslate"><span class="pre">self()</span></code> is a <em>dependent</em> name (i.e. depends on the template parameter but is not declared within the template).</p>
<p><div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span><span class="w"> </span><span class="nc">Base</span><span class="o">&gt;</span><span class="w"> </span><span class="k">struct</span><span class="w"> </span><span class="nc">WithLogging</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">Base</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="nf">Log</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="o">&amp;</span><span class="n">message</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">out</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">message</span><span class="p">;</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>
<span class="w">  </span><span class="k">auto</span><span class="w"> </span><span class="n">LoggerOutput</span><span class="p">()</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">out</span><span class="p">.</span><span class="n">str</span><span class="p">();</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>

<span class="k">private</span><span class="o">:</span><span class="w"></span>
<span class="w">  </span><span class="k">mutable</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">stringstream</span><span class="w"> </span><span class="n">out</span><span class="p">;</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span><span class="w"> </span><span class="nc">Base</span><span class="o">&gt;</span><span class="w"> </span><span class="k">struct</span><span class="w"> </span><span class="nc">Persistence</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">Base</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="nf">Store</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="c1">// self() is provided by Base, so we need to mark it dependent.</span>
<span class="w">    </span><span class="c1">// this-&gt;self() is short and obvious.</span>
<span class="w">    </span><span class="k">this</span><span class="o">-&gt;</span><span class="n">self</span><span class="p">().</span><span class="n">Log</span><span class="p">(</span><span class="s">&quot;storing...&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>
</pre></div>
</div>
 The order in which you use compose the concrete class using the above mixins is not important, thanks to the top layer and to the trick of providing access to the <code class="docutils literal notranslate"><span class="pre">most</span> <span class="pre">derived</span> <span class="pre">class</span></code> via <code class="docutils literal notranslate"><span class="pre">self()</span></code>. In the example below, the two classes, <code class="docutils literal notranslate"><span class="pre">Concrete</span></code> and <code class="docutils literal notranslate"><span class="pre">Concrete2</span></code>, are equivalent:</p>
<p><div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="w">  </span><span class="k">struct</span><span class="w"> </span><span class="nc">Concrete1</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">Mixin</span><span class="o">&lt;</span><span class="n">Concrete1</span><span class="p">,</span><span class="w"> </span><span class="n">Persistence</span><span class="p">,</span><span class="w"> </span><span class="n">WithLogging</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{};</span><span class="w"></span>
<span class="w">  </span><span class="k">struct</span><span class="w"> </span><span class="nc">Concrete2</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">Mixin</span><span class="o">&lt;</span><span class="n">Concrete2</span><span class="p">,</span><span class="w"> </span><span class="n">WithLogging</span><span class="p">,</span><span class="w"> </span><span class="n">Persistence</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{};</span><span class="w"></span>
</pre></div>
</div>
</p>
<div class="section" id="the-mixin-class">
<h2>The mixin class<a class="headerlink" href="#the-mixin-class" title="Permalink to this headline">¶</a></h2>
<dl class="cpp struct">
<dt class="sig sig-object cpp" id="_CPPv4I0I0EDpEN4asap5mixin5MixinE">
<span id="_CPPv3I0I0EDpEN4asap5mixin5MixinE"></span><span id="_CPPv2I0I0EDpEN4asap5mixin5MixinE"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Concrete</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">class</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="k"><span class="pre">class</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="sig-name descname"><span class="n"><span class="pre">Mixins</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="structasap_1_1mixin_1_1_mixin"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-prename descclassname"><span class="n"><span class="pre">asap</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">mixin</span></span><span class="p"><span class="pre">::</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">Mixin</span></span></span><span class="w"> </span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="k"><span class="pre">public</span></span><span class="w"> </span><span class="n"><span class="pre">detail</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">MixinImpl</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0I0EDpEN4asap5mixin5MixinE" title="asap::mixin::Mixin::Concrete"><span class="n"><span class="pre">Concrete</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0I0EDpEN4asap5mixin5MixinE" title="asap::mixin::Mixin::Mixins"><span class="n"><span class="pre">Mixins</span></span></a><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">&gt;</span></span><a class="headerlink" href="#_CPPv4I0I0EDpEN4asap5mixin5MixinE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Mixes multiple mixins in an inheritance chain starting with a <code class="docutils literal notranslate"><span class="pre">MixinTop</span></code> and ending with the <code class="docutils literal notranslate"><span class="pre">Concrete</span></code> class, where each layer inherits from the previous one. </p>
<p>Similar to the rule we set for mixins, where a mixin’s constructor must forward arguments it does not use to its base class, we also require the mixed in class to do the same.</p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Concrete</strong> – The base class to which mixins will be added.</p></li>
<li><p><strong>Mixins</strong> – The list of mixins to be added to the Concrete base class. Each mixin must respect the following requirements: inherits publicly from its <strong>only template parameter</strong> and has a constructor that forwards arguments its does not consume to its base. </p></li>
</ul>
</dd>
</dl>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-functions">Public Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4IDpEN4asap5mixin5Mixin5MixinEDpRR4Rest">
<span id="_CPPv3IDpEN4asap5mixin5Mixin5MixinEDpRR4Rest"></span><span id="_CPPv2IDpEN4asap5mixin5Mixin5MixinEDpRR4Rest"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="sig-name descname"><span class="n"><span class="pre">Rest</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="structasap_1_1mixin_1_1_mixin_1adc624883de4f7de731ca093edf306e33"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="k"><span class="pre">explicit</span></span><span class="w"> </span><span class="k"><span class="pre">constexpr</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Mixin</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4IDpEN4asap5mixin5Mixin5MixinEDpRR4Rest" title="asap::mixin::Mixin::Mixin::Rest"><span class="n"><span class="pre">Rest</span></span></a><span class="p"><span class="pre">&amp;</span></span><span class="p"><span class="pre">&amp;</span></span><span class="p"><span class="pre">...</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">rest</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4IDpEN4asap5mixin5Mixin5MixinEDpRR4Rest" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Constructor that forwards all its arguments to the base class. </p>
</dd></dl>

</div>
</dd></dl>

</div>
<div class="section" id="interfaces-and-mixins">
<h2>Interfaces and mixins<a class="headerlink" href="#interfaces-and-mixins" title="Permalink to this headline">¶</a></h2>
<p>When it comes to mixing interfaces in a composite class, we have two options:</p>
<ol class="arabic simple">
<li><p>Implement the interface in a mixin that gets mixed in.</p></li>
<li><p>Mix a mixin that provides the interface and implement it in the composite
class.</p></li>
</ol>
<div class="section" id="mixin-implements-interface">
<h3>Mixin implements interface<a class="headerlink" href="#mixin-implements-interface" title="Permalink to this headline">¶</a></h3>
<p>A mixin must derive from its only template parameter but can also derive from
any other base class. This property can be exploited to implement an interface
inside a mixin. This is particularly useful when the entire interface makes
sense to be implemented in a single place.</p>
</div>
<div class="section" id="mixin-provides-interface">
<h3>Mixin provides interface<a class="headerlink" href="#mixin-provides-interface" title="Permalink to this headline">¶</a></h3>
<p>Often, the interface API is too big to be implemented in a single mixin. In such
case, we can provide the interface to the composite class via a mixin and
implement its API in any suitable way. The challenge with this is the fact that
we require a mixin to have a single template parameter. To solve this challenge
we use a helper that can curry multiple template parameters and a special mixin
<cite>Provides</cite> that uses the curry helper to provide an interface class to the
composite.</p>
<dl class="cpp struct">
<dt class="sig sig-object cpp" id="_CPPv4IIDpE0DpEN4asap5mixin5CurryE">
<span id="_CPPv3IIDpE0DpEN4asap5mixin5CurryE"></span><span id="_CPPv2IIDpE0DpEN4asap5mixin5CurryE"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">class</span></span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="k"><span class="pre">class</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Mixin</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="sig-name descname"><span class="n"><span class="pre">Args</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="structasap_1_1mixin_1_1_curry"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Curry</span></span></span><a class="headerlink" href="#_CPPv4IIDpE0DpEN4asap5mixin5CurryE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Allows currying of mixin classes with multiple template parameters. </p>
<p><strong>Example</strong></p>
<p><div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span><span class="w"> </span><span class="nc">Arg1</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span><span class="w"> </span><span class="nc">Arg2</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span><span class="w"> </span><span class="nc">Base</span><span class="o">&gt;</span><span class="w"> </span><span class="k">struct</span><span class="w"> </span><span class="nc">MyMixin</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">Base</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span><span class="p">...</span><span class="w"> </span><span class="n">Args</span><span class="o">&gt;</span><span class="w"></span>
<span class="w">  </span><span class="k">constexpr</span><span class="w"> </span><span class="k">explicit</span><span class="w"> </span><span class="n">MyMixin</span><span class="p">(</span><span class="n">Arg1</span><span class="w"> </span><span class="n">field_1</span><span class="p">,</span><span class="w"> </span><span class="n">Arg2</span><span class="w"> </span><span class="n">field_2</span><span class="p">,</span><span class="w"> </span><span class="n">Args</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="p">...</span><span class="n">args</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="o">:</span><span class="w"> </span><span class="n">Base</span><span class="p">(</span><span class="k">static_cast</span><span class="o">&lt;</span><span class="k">decltype</span><span class="p">(</span><span class="n">args</span><span class="p">)</span><span class="o">&gt;</span><span class="p">(</span><span class="n">args</span><span class="p">)...),</span><span class="w"> </span><span class="n">field_1_</span><span class="p">{</span><span class="n">field_1</span><span class="p">},</span><span class="w"></span>
<span class="w">        </span><span class="n">field_2_</span><span class="p">{</span><span class="n">field_2</span><span class="p">}</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>

<span class="k">private</span><span class="o">:</span><span class="w"></span>
<span class="w">  </span><span class="n">Arg1</span><span class="w"> </span><span class="n">field_1_</span><span class="p">;</span><span class="w"></span>
<span class="w">  </span><span class="n">Arg2</span><span class="w"> </span><span class="n">field_2_</span><span class="p">;</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>

<span class="k">struct</span><span class="w"> </span><span class="nc">MyClass</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">Mixin</span><span class="o">&lt;</span><span class="n">MyClass</span><span class="p">,</span><span class="w"> </span><span class="n">mixin</span><span class="o">::</span><span class="n">Curry</span><span class="o">&lt;</span><span class="n">MyMixin</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="p">,</span><span class="w"> </span><span class="kt">float</span><span class="o">&gt;::</span><span class="n">mixin</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span><span class="p">...</span><span class="w"> </span><span class="n">Args</span><span class="o">&gt;</span><span class="w"></span>
<span class="w">  </span><span class="k">constexpr</span><span class="w"> </span><span class="k">explicit</span><span class="w"> </span><span class="n">MyClass</span><span class="p">(</span><span class="n">Args</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="p">...</span><span class="n">args</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="o">:</span><span class="w"> </span><span class="n">Mixin</span><span class="p">(</span><span class="k">static_cast</span><span class="o">&lt;</span><span class="k">decltype</span><span class="p">(</span><span class="n">args</span><span class="p">)</span><span class="o">&gt;</span><span class="p">(</span><span class="n">args</span><span class="p">)...)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>
</pre></div>
</div>
</p>
</dd></dl>

<dl class="cpp struct">
<dt class="sig sig-object cpp" id="_CPPv4I00EN4asap6mixins8ProvidesE">
<span id="_CPPv3I00EN4asap6mixins8ProvidesE"></span><span id="_CPPv2I00EN4asap6mixins8ProvidesE"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Interface</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Base</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">Deferred</span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="structasap_1_1mixins_1_1_provides"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Provides</span></span></span><span class="w"> </span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="k"><span class="pre">public</span></span><span class="w"> </span><span class="n"><span class="pre">asap</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">mixins</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Deferred</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">public</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I00EN4asap6mixins8ProvidesE" title="asap::mixins::Provides::Interface"><span class="n"><span class="pre">Interface</span></span></a><a class="headerlink" href="#_CPPv4I00EN4asap6mixins8ProvidesE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>A mixin that provides an interface to be mixed into the composite class. </p>
<p><strong>Example</strong></p>
<p><div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">struct</span><span class="w"> </span><span class="nc">Interface</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="k">virtual</span><span class="w"> </span><span class="o">~</span><span class="n">Interface</span><span class="p">()</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">default</span><span class="p">;</span><span class="w"></span>
<span class="w">  </span><span class="k">virtual</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">foo</span><span class="p">()</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>
</pre></div>
</div>
 <div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="w">  </span><span class="k">using</span><span class="w"> </span><span class="n">asap</span><span class="o">::</span><span class="n">mixins</span><span class="o">::</span><span class="n">Provides</span><span class="p">;</span><span class="w"></span>
<span class="w">  </span><span class="k">struct</span><span class="w"> </span><span class="nc">Composite</span><span class="w"> </span><span class="k">final</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">Mixin</span><span class="o">&lt;</span><span class="n">Composite</span><span class="p">,</span><span class="w"> </span><span class="n">Provides</span><span class="o">&lt;</span><span class="n">Interface</span><span class="o">&gt;::</span><span class="n">mixin</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">foo</span><span class="p">()</span><span class="w"> </span><span class="k">override</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">      </span><span class="c1">// Implement foo interface in the composite</span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">  </span><span class="p">};</span><span class="w"></span>
</pre></div>
</div>
</p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters</dt>
<dd class="field-odd"><p><strong>Interface</strong> – - the abstract base class to add to the interface. The rest are implementation details.</p>
</dd>
</dl>
</dd></dl>

</div>
</div>
</div>


              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="overload.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">The overload pattern</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="flags.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Masks/Flags manipulation helpers</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
        &copy; Copyright 2022, The Authors.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>